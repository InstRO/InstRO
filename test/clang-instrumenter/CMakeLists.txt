set(INSTRO_PROJECT_DIR ${PROJECT_SOURCE_DIR})
set(INSTRO_BIN_DIR ${CMAKE_BINARY_DIR})
set(INSTRO_LIB_DIR ${CMAKE_BINARY_DIR}/lib/)
set(LIT_SITE_CFG_IN_HEADER "## Autogenerated from ${input}\n## Do not edit!")

configure_file(${CMAKE_CURRENT_SOURCE_DIR}/lit.site.cfg.in
        ${CMAKE_CURRENT_BINARY_DIR}/lit.site.cfg @ONLY)

configure_file(${CMAKE_CURRENT_SOURCE_DIR}/instrument.sh.in
        ${CMAKE_CURRENT_BINARY_DIR}/instrument.sh @ONLY)

add_lit_testsuite(instrumenter-tests
        "Tests for the Clang instrumenter"
        ${CMAKE_CURRENT_SOURCE_DIR}
        ARGS -v -j 1
        PARAMS instro_site_config=${CMAKE_CURRENT_BINARY_DIR}/lit.site.cfg
        DEPENDS ClangInstrumentor
        )

add_test(
        NAME ctest_lit_suite COMMAND
        ${LIT_COMMAND_I} -j 1 --param instro_site_config=${CMAKE_CURRENT_BINARY_DIR}/lit.site.cfg ${CMAKE_CURRENT_SOURCE_DIR}
)